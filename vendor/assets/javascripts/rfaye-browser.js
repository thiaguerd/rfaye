// Generated by CoffeeScript 1.10.0
(function() {
  this.Rfaye = {
    subs: {},
    sub: function(channel, func, overwrite) {
      if (overwrite == null) {
        overwrite = false;
      }
      if (channel.substring(0, 1) !== "/") {
        channel = "/" + channel;
      }
      if (!Rfaye.subs[channel]) {
        if (!func) {
          func = function(data) {
            var e, error;
            try {
              return eval(data);
            } catch (error) {
              e = error;
              if (e instanceof SyntaxError) {
                return eval(data.substring(data.indexOf("{") + 1, data.lastIndexOf("}")));
              }
            }
          };
        }
        return Rfaye.subs[channel] = new Faye.Client('http://' + window.location.hostname + ':9292/faye').subscribe(channel, func);
      } else if (overwrite) {
        Rfaye.subs[channel].cancel();
        Rfaye.subs[channel] = void 0;
        return Rfaye.sub(channel, func);
      }
    },
    un_sub: function(channel) {
      if (channel.substring(0, 1) !== "/") {
        channel = "/" + channel;
      }
      if (Rfaye.subs[channel]) {
        return Rfaye.subs[channel].cancel();
      }
    },
    pub: function(channel, data) {
      if (channel.substring(0, 1) !== "/") {
        channel = "/" + channel;
      }
      return new Faye.Client("http://" + window.location.hostname + ":9292/faye").publish(channel, data.toString());
    }
  };

}).call(this);
